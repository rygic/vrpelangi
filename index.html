<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pelangi VR : Introducing Legends and Origins of Sidoarjo Through VR Technology</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            background: #000;
        }
        
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            color: white;
            transition: opacity 1s ease;
        }
        
        .loading-logo {
            font-size: 3.5rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 0 10px rgba(255,255,255,0.5);
        }
        
        .loading-subtitle {
            font-size: 1.5rem;
            margin-bottom: 30px;
            text-align: center;
            max-width: 80%;
        }
        
        .loading-bar-container {
            width: 300px;
            height: 6px;
            background: rgba(255,255,255,0.3);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        .loading-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #fdbb2d, #b21f1f);
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        
        .loading-text {
            font-size: 1rem;
        }
        
        #ui-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            pointer-events: none;
        }
        
        #header {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px 20px;
            text-align: center;
            backdrop-filter: blur(10px);
            border-bottom: 2px solid #fdbb2d;
        }
        
        #header h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
            color: #fdbb2d;
        }
        
        #header p {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        #info-panel {
            position: absolute;
            top: 120px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            max-width: 350px;
            backdrop-filter: blur(10px);
            border-left: 4px solid #b21f1f;
            pointer-events: auto;
            transform: translateX(-100%);
            transition: transform 0.5s ease;
        }
        
        #info-panel.active {
            transform: translateX(0);
        }
        
        #info-toggle {
            position: absolute;
            top: 120px;
            left: 20px;
            background: #b21f1f;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 1.5rem;
            cursor: pointer;
            pointer-events: auto;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            z-index: 1001;
        }
        
        #info-panel h2 {
            color: #fdbb2d;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        
        #info-panel p {
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .legend-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        
        .legend-item:last-child {
            border-bottom: none;
        }
        
        .legend-item h3 {
            color: #1a2a6c;
            margin-bottom: 8px;
            font-size: 1.2rem;
        }
        
        .vr-badge {
            display: inline-block;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-top: 10px;
        }
        
        #navigation {
            position: absolute;
            bottom: 30px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 15px;
            pointer-events: auto;
        }
        
        .nav-btn {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.5rem;
            cursor: pointer;
            backdrop-filter: blur(10px);
            border: 2px solid #fdbb2d;
            transition: all 0.3s ease;
        }
        
        .nav-btn:hover {
            background: rgba(178, 31, 31, 0.8);
            transform: scale(1.1);
        }
        
        #credits {
            position: absolute;
            bottom: 10px;
            right: 10px;
            color: white;
            font-size: 0.8rem;
            opacity: 0.7;
            text-align: right;
        }
        
        #video-error {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            z-index: 999;
            display: none;
        }
        
        @media (max-width: 768px) {
            #header h1 {
                font-size: 1.4rem;
            }
            
            #header p {
                font-size: 0.9rem;
            }
            
            #info-panel {
                max-width: 280px;
            }
            
            .nav-btn {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loading-logo">PELANGI VR</div>
        <div class="loading-subtitle">Introducing Legends and Origins of Sidoarjo Through VR Technology</div>
        <div class="loading-bar-container">
            <div class="loading-bar" id="loading-bar"></div>
        </div>
        <div class="loading-text" id="loading-text">Memuat pengalaman VR...</div>
    </div>

    <!-- Error Message -->
    <div id="video-error">
        <h3>Video Tidak Dapat Dimuat</h3>
        <p>Pastikan koneksi internet stabil dan video tersedia.</p>
        <button id="retry-btn" style="margin-top: 15px; padding: 10px 20px; background: #fdbb2d; border: none; border-radius: 5px; cursor: pointer;">Coba Lagi</button>
    </div>

    <!-- UI Container -->
    <div id="ui-container">
        <div id="header">
            <h1>Pelangi VR</h1>
            <p>Introducing Legends and Origins of Sidoarjo Through VR Technology</p>
        </div>
        
        <button id="info-toggle">‚ÑπÔ∏è</button>
        
        <div id="info-panel">
            <h2>Legenda Sidoarjo</h2>
            <p>Jelajahi sejarah dan mitos asal-usul Kabupaten Sidoarjo melalui teknologi Virtual Reality.</p>
            
            <div class="legend-item">
                <h3>Asal Nama Sidoarjo</h3>
                <p>Nama Sidoarjo berasal dari kata "Sido" yang berarti "menjadi" dan "Arjo" yang berarti "berharga". Konon nama ini diberikan oleh seorang bupati yang berharap wilayah ini menjadi daerah yang makmur dan berharga.</p>
            </div>
            
            <div class="legend-item">
                <h3>Legenda Joko Bayu</h3>
                <p>Kisah Joko Bayu dan perjuangannya melawan penjajah Belanda di wilayah Sidoarjo. Joko Bayu dikenal sebagai pahlawan lokal yang gigih mempertahankan tanah kelahirannya.</p>
            </div>
            
            <div class="legend-item">
                <h3>Mitos Sumber Air</h3>
                <p>Legenda tentang sumber air ajaib yang memberikan kesuburan pada tanah Sidoarjo. Konon sumber air ini ditemukan oleh seorang pertapa yang sedang bertapa di wilayah ini.</p>
            </div>
            
            <div class="vr-badge">VR Technology Experience</div>
        </div>
        
        <div id="navigation">
            <button class="nav-btn" id="play-btn">‚ñ∂</button>
            <button class="nav-btn" id="vr-btn">üëì</button>
            <button class="nav-btn" id="fullscreen-btn">‚õ∂</button>
        </div>
        
        <div id="credits">
            Pelangi VR Experience<br>
            ¬© 2023 Sidoarjo Heritage
        </div>
    </div>

    <!-- A-Frame Scene -->
    <a-scene>
        <!-- Assets dengan video langsung -->
        <a-assets>
            <!-- Video 360 dari YouTube menggunakan iframe -->
            <video id="sidoarjo-video" autoplay loop crossorigin="anonymous" playsinline webkit-playsinline>
                <!-- Fallback video source -->
                <source src="https://www.youtube.com/embed/5Jyx7XXESI4?autoplay=1&mute=1&controls=0&modestbranding=1&rel=0" type="video/mp4">
            </video>
        </a-assets>

        <!-- Sky dengan video 360 -->
        <a-videosphere 
            src="#sidoarjo-video"
            rotation="0 -90 0">
        </a-videosphere>

        <!-- Kamera dengan kontrol VR -->
        <a-entity camera look-controls wasd-controls position="0 1.6 0">
            <a-cursor></a-cursor>
        </a-entity>

        <!-- Obyek 3D interaktif -->
        <a-entity id="legend-marker" geometry="primitive: box; width: 0.5; height: 0.5; depth: 0.5" 
                  material="color: #fdbb2d; shader: flat" 
                  position="3 1.5 -5" 
                  animation="property: rotation; to: 0 360 0; loop: true; dur: 10000">
            <a-text value="Legenda Sidoarjo" align="center" position="0 0.8 0" color="#1a2a6c" scale="2 2 2"></a-text>
        </a-entity>

        <!-- Lighting -->
        <a-light type="ambient" color="#4455aa"></a-light>
        <a-light type="directional" color="#ffffff" intensity="0.8" position="-0.5 1 1"></a-light>
        
        <!-- Ground plane -->
        <a-plane 
            position="0 0 -4" 
            rotation="-90 0 0" 
            width="100" 
            height="100" 
            color="#2d5b2d"
            shadow="receive: true">
        </a-plane>
    </a-scene>

    <script>
        // Simulasi loading progress
        let progress = 0;
        const loadingBar = document.getElementById('loading-bar');
        const loadingText = document.getElementById('loading-text');
        const loadingScreen = document.getElementById('loading-screen');
        const videoError = document.getElementById('video-error');
        const retryBtn = document.getElementById('retry-btn');
        
        const loadingInterval = setInterval(() => {
            progress += Math.random() * 10;
            if (progress > 100) progress = 100;
            
            loadingBar.style.width = `${progress}%`;
            
            if (progress < 30) {
                loadingText.textContent = "Memuat aset 3D...";
            } else if (progress < 60) {
                loadingText.textContent = "Menyiapkan lingkungan VR...";
            } else if (progress < 90) {
                loadingText.textContent = "Memuat konten legenda Sidoarjo...";
            } else {
                loadingText.textContent = "Hampir selesai...";
            }
            
            if (progress === 100) {
                clearInterval(loadingInterval);
                setTimeout(() => {
                    loadingScreen.style.opacity = "0";
                    setTimeout(() => {
                        loadingScreen.style.display = "none";
                        checkVideoStatus();
                    }, 1000);
                }, 500);
            }
        }, 200);
        
        // Cek status video
        function checkVideoStatus() {
            const video = document.querySelector('#sidoarjo-video');
            setTimeout(() => {
                if (video.readyState === 0 || video.networkState === 3) {
                    videoError.style.display = 'block';
                }
            }, 3000);
        }
        
        // Retry button
        retryBtn.addEventListener('click', () => {
            videoError.style.display = 'none';
            const video = document.querySelector('#sidoarjo-video');
            video.load();
        });
        
        // Toggle info panel
        const infoToggle = document.getElementById('info-toggle');
        const infoPanel = document.getElementById('info-panel');
        
        infoToggle.addEventListener('click', () => {
            infoPanel.classList.toggle('active');
        });
        
        // Navigation buttons
        const playBtn = document.getElementById('play-btn');
        const vrBtn = document.getElementById('vr-btn');
        const fullscreenBtn = document.getElementById('fullscreen-btn');
        
        playBtn.addEventListener('click', () => {
            const video = document.querySelector('#sidoarjo-video');
            if (video.paused) {
                video.play().catch(e => {
                    console.log('Video play failed:', e);
                    video.muted = true;
                    video.play();
                });
                playBtn.textContent = '‚è∏';
            } else {
                video.pause();
                playBtn.textContent = '‚ñ∂';
            }
        });
        
        vrBtn.addEventListener('click', () => {
            const scene = document.querySelector('a-scene');
            if (scene.hasAttribute('vr-mode-ui')) {
                scene.enterVR();
            }
        });
        
        fullscreenBtn.addEventListener('click', () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log(`Error attempting to enable fullscreen: ${err.message}`);
                });
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        });
        
        // Handle VR mode changes
        window.addEventListener('enter-vr', () => {
            document.getElementById('ui-container').style.display = 'none';
        });
        
        window.addEventListener('exit-vr', () => {
            document.getElementById('ui-container').style.display = 'block';
        });
        
        // Auto-play video dengan mute (kebijakan browser)
        document.addEventListener('DOMContentLoaded', () => {
            const video = document.querySelector('#sidoarjo-video');
            video.muted = true;
            video.play().catch(e => {
                console.log('Autoplay dengan mute gagal:', e);
            });
        });
    </script>
</body>
</html>
